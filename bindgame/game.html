<!DOCTYPE html>
<html>
<head>
	<title>bindgame</title>
	<style type="text/css">
	canvas{
		border: 1px black solid;
	}
</style>

<script src="game.js"></script>
<script src="block.js"></script>
<script src="bond.js"></script>
<script src="ball.js"></script>

</head>
<body>
	<canvas id="id-canvas" width="800" height="800"></canvas>
	<script type="text/javascript">
		var log=console.log.bind(console)
		var imageFrompPath=function(path){
			var img=new Image();
			img.src=path
			return img;
		}
		var rectIntersects = function (a,b) {
			if(b.y > a.y && b.y < a.y + a.image.height ) {
				if(b.x > a.x && b.x < a.x + a.image.width ){
					return true
				}
			}
			return false
		}
		
		var blocks = [] 
		for (var i = 0; i < 6; i++) {
			var b = Block()
			blocks.push(b)
			b.x = i * 150
			b.y = 200

		}
		var pausd = false
		
        var __main=function() {
        	var game = Game(10)
        	var bond = Bond()	
        	var ball = Ball()	
        	var  block = Block()
        	
        	game.registerAction('a',function() {
        		bond.moveLeft()
        	})
        	game.registerAction('d',function() {
        		bond.moveRight()
        	})
        	game.registerAction('f',function() {
        		ball.fire()
        	})

			//update
			game.update=function() {
				if (pausd) {
					return 
				}
				ball.move()
				//板子和球的相撞
				if(bond.collide(ball)){
					ball.speedY=-ball.speedY
				}
				//球和砖的相撞
				for (var i = 0; i < blocks.length; i++) {
					var block = blocks[i]
					if (block.collide(ball)) {
						block.kill()
					}
				}
			}
			//draw

			game.draw=function() {
				game.drawImage(bond)
				game.drawImage(ball)
				for (var i = 0; i < blocks.length; i++) {
					var block = blocks[i]
					if(block.alive) {
						game.drawImage(block)
					}
				}
			}
		}
		__main()
	</script>
</body>
</html>