<!DOCTYPE html>
<html>
<head>
	<title>bindgame</title>
	<style type="text/css">
	canvas{
		border: 1px black solid;
	}
</style>
</head>
<body>
	<canvas id="id-canvas" width="800" height="800"></canvas>
	<script type="text/javascript">
		var log=console.log.bind(console)
		var imageFrompPath=function(path){
			var img=new Image();
			img.src=path
			return img;
		}
		var Bond=function(){
			var image=imageFrompPath('images/bond.png')
			var o={
				image: image,
				x:  200,
				y: 600,
				speed:  3,
			}
			o.moveLeft=function(){
				this.x-=this.speed
			}
			o.moveRight=function(){
				this.x+=this.speed
			}
			return o
		}
		var Game=function(){
			var g={
				actions: {},
				keydowns: {},
			}
			var canvas=document.querySelector('#id-canvas')
			var context=canvas.getContext('2d')
			g.canvas=canvas
			g.context=context
			g.drawImage=function(Image){
				g.context.drawImage(Image.image,Image.x,Image.y)
			}

			//event
            window.addEventListener('keydown',function(event){
            	g.keydowns[event.key]=true
            })
            window.addEventListener('keyup',function(event){
            	g.keydowns[event.key]=false
            })
            g.registerAction=function(key,callback){
            	g.actions[key]=callback
            }
            //timer
			setInterval(function(){
				//update event
				var actions=Object.keys(g.actions)
				for (var i = 0; i <actions.length; i++) {
					var key=actions[i]
					if(g.keydowns[key])
						g.actions[key]()
					}
				//clare
				context.clearRect(0,0,canvas.width,canvas.height)
				//draw
				g.draw()
			}, 10)
			return g;
		}
		var __main=function(){
			var game=Game();
			var bond=Bond()			
			game.registerAction('a',function(){
				bond.moveLeft()
			})
			game.registerAction('d',function(){
				bond.moveRight()
			})
			//update
			game.update=function(){

			}
			//draw
            game.draw=function(){
            	game.drawImage(bond)

            }
    }
    __main()
    </script>
</body>
</html>